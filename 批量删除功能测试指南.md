# 学生和分组批量删除功能测试指南

## 功能概述

本次更新为SIQCS系统添加了完善的批量删除功能：

### 学生管理批量删除功能
1. **按选择删除**：在学生列表中选择多个学生，点击"批量删除"按钮
2. **按批次删除**：选择特定的导入批次，删除该批次的所有学生
3. **删除所有学生**：危险操作，删除系统中的所有学生数据

### 分组管理批量删除功能
1. **按选择删除**：在分组列表中选择多个分组，点击"批量删除"按钮
2. **自定义选择删除**：通过穿梭框界面灵活选择要删除的分组
3. **删除所有分组**：危险操作，删除系统中的所有分组和分配数据

## 新增API接口

### 后端接口

#### 学生批量删除接口
- **路径**: `DELETE /api/students/bulk_delete/`
- **参数**:
  - `student_ids`: 学生ID数组（可选）
  - `import_batch`: 导入批次名称（可选）
  - `delete_all`: 是否删除所有（布尔值，可选）

#### 分组批量删除接口
- **路径**: `DELETE /api/groups/bulk_delete/`
- **参数**:
  - `group_ids`: 分组ID数组（可选）
  - `group_names`: 分组名称数组（可选）
  - `delete_all`: 是否删除所有（布尔值，可选）

#### 导入批次查询接口
- **路径**: `GET /api/students/import_batches/`
- **返回**: 所有导入批次及其学生数量统计

### 前端组件

#### 新增组件
1. `StudentBulkDeleteModal.tsx` - 学生批量删除模态框
2. `GroupBulkDeleteModal.tsx` - 分组批量删除模态框

#### 更新组件
1. `StudentList.tsx` - 添加行选择和批量删除功能
2. `GroupManagement.tsx` - 添加行选择和批量删除功能

## 测试步骤

### 前提条件
1. 确保后端服务正在运行
2. 确保前端服务正在运行
3. 系统中有测试数据（学生和分组信息）

### 学生批量删除测试

#### 测试1：按选择删除学生
1. 访问学生列表页面 (`http://localhost:3000/students`)
2. 在表格中选择多个学生（点击复选框）
3. 点击"批量删除"按钮
4. 在弹出的模态框中，删除方式应默认为"删除选中的学生"
5. 确认删除操作
6. 验证选中的学生已被删除

#### 测试2：按批次删除学生
1. 访问学生列表页面
2. 点击"批量删除"按钮
3. 在模态框中选择"按批次删除"
4. 从下拉菜单中选择一个批次
5. 确认删除操作
6. 验证该批次的所有学生已被删除

#### 测试3：删除所有学生（谨慎测试）
1. 访问学生列表页面
2. 点击"批量删除"按钮
3. 在模态框中选择"删除所有学生"
4. 勾选确认复选框
5. 确认删除操作
6. 验证所有学生数据已被清空

### 分组批量删除测试

#### 测试4：按选择删除分组
1. 访问分组管理页面 (`http://localhost:3000/groups`)
2. 在表格中选择多个分组（点击复选框）
3. 点击"批量删除"按钮
4. 在弹出的模态框中，删除方式应默认为"删除选中的分组"
5. 确认删除操作
6. 验证选中的分组及其分配记录已被删除

#### 测试5：自定义选择删除分组
1. 访问分组管理页面
2. 点击"批量删除"按钮
3. 在模态框中选择"自定义选择分组"
4. 使用穿梭框选择要删除的分组
5. 确认删除操作
6. 验证选择的分组已被删除

#### 测试6：删除所有分组（谨慎测试）
1. 访问分组管理页面
2. 点击"批量删除"按钮
3. 在模态框中选择"删除所有分组"
4. 勾选确认复选框
5. 确认删除操作
6. 验证所有分组和分配数据已被清空

## 安全特性

1. **危险操作提示**：删除所有数据时有明确的警告信息
2. **二次确认**：重要操作需要用户明确确认
3. **关联数据处理**：删除分组时会同时删除相关的学生分配记录
4. **选择状态管理**：删除操作完成后自动清空选择状态

## 错误处理

1. **网络错误**：显示友好的错误消息
2. **权限错误**：提示用户权限不足
3. **数据验证**：确保用户选择了有效的删除目标
4. **服务器错误**：记录详细错误信息并显示用户友好的消息

## 注意事项

1. **数据备份**：在进行批量删除操作前，建议备份重要数据
2. **权限控制**：生产环境中应该添加适当的权限控制
3. **日志记录**：重要的删除操作应该记录操作日志
4. **软删除**：考虑实现软删除机制以支持数据恢复

## 部署后验证清单

- [ ] 前端编译成功
- [ ] 后端API响应正常
- [ ] 学生批量删除功能正常
- [ ] 分组批量删除功能正常
- [ ] 错误处理机制正常
- [ ] 用户界面友好且易用
- [ ] 数据一致性保持正确
